---
title: MR Sharing 250-HoloLens y auriculares envolventes
description: Siga este tutorial de codificación con auriculares con Unity, Visual Studio, HoloLens y Windows Mixed Reality para obtener información detallada sobre el uso compartido de hologramas entre dispositivos de realidad mixta.
author: keveleigh
ms.author: kurtie
ms.date: 03/21/2018
ms.topic: article
keywords: holotoolkit, mixedrealitytoolkit, mixedrealitytoolkit-Unity, inmersivo, controlador de movimiento, uso compartido, controladora Xbox, redes, dispositivos cruzados
ms.openlocfilehash: 9e1cb0d168b8bf830b4477190516cd19caef7972
ms.sourcegitcommit: 915d3cc63a5571ba22ac4608589f3eca8da1bc81
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/24/2019
ms.locfileid: "63506115"
---
>[!NOTE]
><span data-ttu-id="deb4c-104">Los tutoriales de la Academia de realidad mixta se han diseñado con HoloLens (1º generación) y con auriculares de realidad mixta en mente.</span><span class="sxs-lookup"><span data-stu-id="deb4c-104">The Mixed Reality Academy tutorials were designed with HoloLens (1st gen) and Mixed Reality Immersive Headsets in mind.</span></span>  <span data-ttu-id="deb4c-105">Como tal, creemos que es importante dejar estos tutoriales en vigor para los desarrolladores que sigan buscando instrucciones para el desarrollo de esos dispositivos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-105">As such, we feel it is important to leave these tutorials in place for developers who are still looking for guidance in developing for those devices.</span></span>  <span data-ttu-id="deb4c-106">Estos tutoriales **_no_** se actualizarán con los conjuntos de herramientas o las interacciones más recientes que se usan para HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="deb4c-106">These tutorials will **_not_** be updated with the latest toolsets or interactions being used for HoloLens 2.</span></span>  <span data-ttu-id="deb4c-107">Se mantendrán para seguir trabajando en los dispositivos compatibles.</span><span class="sxs-lookup"><span data-stu-id="deb4c-107">They will be maintained to continue working on the supported devices.</span></span> <span data-ttu-id="deb4c-108">Habrá una nueva serie de tutoriales que se publicarán en el futuro que mostrarán cómo desarrollar para HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="deb4c-108">There will be a new series of tutorials that will be posted in the future that will demonstrate how to develop for HoloLens 2.</span></span>  <span data-ttu-id="deb4c-109">Este aviso se actualizará con un vínculo a esos tutoriales cuando se publiquen.</span><span class="sxs-lookup"><span data-stu-id="deb4c-109">This notice will be updated with a link to those tutorials when they are posted.</span></span>

<br>

# <a name="mr-sharing-250-hololens-and-immersive-headsets"></a><span data-ttu-id="deb4c-110">Uso compartido de MR 250: HoloLens y auriculares envolvente</span><span class="sxs-lookup"><span data-stu-id="deb4c-110">MR Sharing 250: HoloLens and immersive headsets</span></span>

<span data-ttu-id="deb4c-111">Con la flexibilidad de Plataforma universal de Windows (UWP), es fácil crear una aplicación que abarque varios dispositivos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-111">With the flexibility of Universal Windows Platform (UWP), it is easy to create an application that spans multiple devices.</span></span> <span data-ttu-id="deb4c-112">Con esta flexibilidad, podemos crear experiencias que aprovechen las ventajas de cada dispositivo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-112">With this flexibility, we can create experiences that leverage the strengths of each device.</span></span> <span data-ttu-id="deb4c-113">En este tutorial se tratará una experiencia básica compartida que se ejecuta tanto en HoloLens como en Windows Mixed Reality.</span><span class="sxs-lookup"><span data-stu-id="deb4c-113">This tutorial will cover a basic shared experience that runs on both HoloLens and Windows Mixed Reality immersive headsets.</span></span> <span data-ttu-id="deb4c-114">Este contenido se entregó originalmente en la Conferencia de Microsoft Build 2017 en Seattle, WA.</span><span class="sxs-lookup"><span data-stu-id="deb4c-114">This content was originally delivered at the Microsoft Build 2017 conference in Seattle, WA.</span></span>

<span data-ttu-id="deb4c-115">**En este tutorial, haremos lo siguiente:**</span><span class="sxs-lookup"><span data-stu-id="deb4c-115">**In this tutorial, we will:**</span></span>

* <span data-ttu-id="deb4c-116">Configure una red mediante UNET.</span><span class="sxs-lookup"><span data-stu-id="deb4c-116">Setup a network using UNET.</span></span>
* <span data-ttu-id="deb4c-117">Comparta hologramas en dispositivos de realidad mixta.</span><span class="sxs-lookup"><span data-stu-id="deb4c-117">Share holograms across mixed reality devices.</span></span>
* <span data-ttu-id="deb4c-118">Establezca una vista diferente de la aplicación en función del dispositivo de realidad mixta que se esté usando.</span><span class="sxs-lookup"><span data-stu-id="deb4c-118">Establish a different view of the application depending on which mixed reality device is being used.</span></span>
* <span data-ttu-id="deb4c-119">Cree una experiencia compartida en la que los usuarios de HoloLens guíen a los auriculares a través de algunos rompecabezas sencillos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-119">Create a shared experience where HoloLens users guide immersive headsets users through some simple puzzles.</span></span>

## <a name="device-support"></a><span data-ttu-id="deb4c-120">Compatibilidad con dispositivos</span><span class="sxs-lookup"><span data-stu-id="deb4c-120">Device support</span></span>

<table>
<tr>
<th><span data-ttu-id="deb4c-121">Recurso</span><span class="sxs-lookup"><span data-stu-id="deb4c-121">Course</span></span></th><th style="width:150px"> <span data-ttu-id="deb4c-122"><a href="hololens-hardware-details.md">HoloLens</a></span><span class="sxs-lookup"><span data-stu-id="deb4c-122"><a href="hololens-hardware-details.md">HoloLens</a></span></span></th><th style="width:150px"> <span data-ttu-id="deb4c-123"><a href="immersive-headset-hardware-details.md">Cascos envolventes</a></span><span class="sxs-lookup"><span data-stu-id="deb4c-123"><a href="immersive-headset-hardware-details.md">Immersive headsets</a></span></span></th>
</tr><tr>
<td><span data-ttu-id="deb4c-124">Uso compartido de MR 250: HoloLens y auriculares envolvente</span><span class="sxs-lookup"><span data-stu-id="deb4c-124">MR Sharing 250: HoloLens and immersive headsets</span></span></td><td style="text-align: center;"> <span data-ttu-id="deb4c-125">✔️</span><span class="sxs-lookup"><span data-stu-id="deb4c-125">✔️</span></span></td><td style="text-align: center;"> <span data-ttu-id="deb4c-126">✔️</span><span class="sxs-lookup"><span data-stu-id="deb4c-126">✔️</span></span></td>
</tr>
</table>

## <a name="before-you-start"></a><span data-ttu-id="deb4c-127">Antes de comenzar</span><span class="sxs-lookup"><span data-stu-id="deb4c-127">Before you start</span></span>

### <a name="prerequisites"></a><span data-ttu-id="deb4c-128">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="deb4c-128">Prerequisites</span></span>

* <span data-ttu-id="deb4c-129">Un equipo con Windows 10 con las [herramientas de desarrollo necesarias](install-the-tools.md) y configurada [para admitir un casco con Windows Mixed Reality](https://docs.microsoft.com/windows/mixed-reality/enthusiast-guide/windows-mixed-reality-minimum-pc-hardware-compatibility-guidelines).</span><span class="sxs-lookup"><span data-stu-id="deb4c-129">A Windows 10 PC with the [necessary development tools](install-the-tools.md) and [configured to support a Windows Mixed Reality immersive headset](https://docs.microsoft.com/windows/mixed-reality/enthusiast-guide/windows-mixed-reality-minimum-pc-hardware-compatibility-guidelines).</span></span>
* <span data-ttu-id="deb4c-130">Un controlador de Xbox que funcione con su PC.</span><span class="sxs-lookup"><span data-stu-id="deb4c-130">An Xbox controller that works with your PC.</span></span>
* <span data-ttu-id="deb4c-131">Al menos un dispositivo HoloLens y un casco envolvente.</span><span class="sxs-lookup"><span data-stu-id="deb4c-131">At least one HoloLens device and one immersive headset.</span></span>
* <span data-ttu-id="deb4c-132">Una red que permite la difusión de UDP para la detección.</span><span class="sxs-lookup"><span data-stu-id="deb4c-132">A network which allows UDP Broadcast for discovery.</span></span>

### <a name="project-files"></a><span data-ttu-id="deb4c-133">Archivos de proyecto</span><span class="sxs-lookup"><span data-stu-id="deb4c-133">Project files</span></span>

* <span data-ttu-id="deb4c-134">Descargue los [archivos](https://github.com/Microsoft/MixedReality250/archive/master.zip) requeridos por el proyecto.</span><span class="sxs-lookup"><span data-stu-id="deb4c-134">Download the [files](https://github.com/Microsoft/MixedReality250/archive/master.zip) required by the project.</span></span> <span data-ttu-id="deb4c-135">Extraiga los archivos a una ubicación fácil de recordar.</span><span class="sxs-lookup"><span data-stu-id="deb4c-135">Extract the files to an easy to remember location.</span></span>
* <span data-ttu-id="deb4c-136">Este proyecto requiere [una versión recomendada de Unity con compatibilidad con Windows Mixed Reality](install-the-tools.md).</span><span class="sxs-lookup"><span data-stu-id="deb4c-136">This project requires the [a recommended version of Unity with Windows Mixed Reality support](install-the-tools.md).</span></span>

>[!NOTE]
><span data-ttu-id="deb4c-137">Si desea examinar el código fuente antes de la descarga, está [disponible en github](https://github.com/Microsoft/MixedReality250).</span><span class="sxs-lookup"><span data-stu-id="deb4c-137">If you want to look through the source code before downloading, it's [available on GitHub](https://github.com/Microsoft/MixedReality250).</span></span>

## <a name="chapter-1---holo-world"></a><span data-ttu-id="deb4c-138">Capítulo 1: Hololens World</span><span class="sxs-lookup"><span data-stu-id="deb4c-138">Chapter 1 - Holo World</span></span>

>[!VIDEO https://www.youtube.com/embed/IC0rp6rLiEc]

### <a name="objectives"></a><span data-ttu-id="deb4c-139">Objetivos</span><span class="sxs-lookup"><span data-stu-id="deb4c-139">Objectives</span></span>

<span data-ttu-id="deb4c-140">Asegúrese de que el entorno de desarrollo está listo para usar un proyecto sencillo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-140">Make sure the development environment is ready to go with a simple project.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="deb4c-141">Lo que se va a crear</span><span class="sxs-lookup"><span data-stu-id="deb4c-141">What we will build</span></span>

<span data-ttu-id="deb4c-142">Una aplicación que muestra un holograma en HoloLens o en un auricular envolvente de Windows Mixed Reality.</span><span class="sxs-lookup"><span data-stu-id="deb4c-142">An application that shows a hologram on either HoloLens or a Windows Mixed Reality immersive headset.</span></span>

### <a name="steps"></a><span data-ttu-id="deb4c-143">Pasos</span><span class="sxs-lookup"><span data-stu-id="deb4c-143">Steps</span></span>
* <span data-ttu-id="deb4c-144">Abra Unity.</span><span class="sxs-lookup"><span data-stu-id="deb4c-144">Open Unity.</span></span>
    * <span data-ttu-id="deb4c-145">Seleccione **abrir**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-145">Select **Open**.</span></span>
    * <span data-ttu-id="deb4c-146">Vaya a la ubicación donde extrajo los archivos del proyecto.</span><span class="sxs-lookup"><span data-stu-id="deb4c-146">Navigate to where you extracted the project files.</span></span>
    * <span data-ttu-id="deb4c-147">Haga clic en **Seleccionar carpeta**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-147">Click **Select Folder**.</span></span>
    * <span data-ttu-id="deb4c-148">*Para que Unity procese el proyecto por primera vez, se tardará un poco.*</span><span class="sxs-lookup"><span data-stu-id="deb4c-148">*It will take a little while for Unity to process the project the first time.*</span></span>
* <span data-ttu-id="deb4c-149">Compruebe que la realidad mixta está habilitada en Unity.</span><span class="sxs-lookup"><span data-stu-id="deb4c-149">Check that Mixed Reality is enabled in Unity.</span></span>
    * <span data-ttu-id="deb4c-150">Abra el cuadro de diálogo Configuración de compilación (**Control + Mayús + B** o **configuración de compilación de > de archivos...** ).</span><span class="sxs-lookup"><span data-stu-id="deb4c-150">Open the build settings dialog (**Control+Shift+B** or **File > Build Settings...**).</span></span>
    * <span data-ttu-id="deb4c-151">Seleccione **plataforma universal de Windows** , a continuación, haga clic en **cambiar plataforma**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-151">Select **Universal Windows Platform** then click **Switch Platform**.</span></span>
    * <span data-ttu-id="deb4c-152">Seleccione **editar > configuración del reproductor**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-152">Select **Edit>Player Settings**.</span></span>
    * <span data-ttu-id="deb4c-153">En el panel **Inspector** , en el lado derecho, expanda la **configuración de XR**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-153">In the **Inspector** panel on the right hand side, expand **XR Settings**.</span></span>
    * <span data-ttu-id="deb4c-154">Active la casilla se **admite Virtual Reality** .</span><span class="sxs-lookup"><span data-stu-id="deb4c-154">Check the **Virtual Reality Supported** box.</span></span>
    * <span data-ttu-id="deb4c-155">*Windows Mixed Reality debe ser el SDK de realidad virtual.*</span><span class="sxs-lookup"><span data-stu-id="deb4c-155">*Windows Mixed Reality should be the Virtual Reality SDK.*</span></span>
* <span data-ttu-id="deb4c-156">Cree una escena.</span><span class="sxs-lookup"><span data-stu-id="deb4c-156">Create a scene.</span></span>
    * <span data-ttu-id="deb4c-157">En la **jerarquía** , haga clic con el botón secundario en **cámara principal** y seleccione **eliminar**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-157">In the **Hierarchy** right click **Main Camera** select **Delete**.</span></span>
    * <span data-ttu-id="deb4c-158">En **HoloToolkit > entrada > Prefabs** arrastre **MixedRealityCameraParent** hasta la **jerarquía**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-158">From **HoloToolkit > Input > Prefabs** drag **MixedRealityCameraParent** to the **Hierarchy**.</span></span>
* <span data-ttu-id="deb4c-159">Agregar hologramas a la escena</span><span class="sxs-lookup"><span data-stu-id="deb4c-159">Add Holograms to the scene</span></span>
    * <span data-ttu-id="deb4c-160">En **AppPrefabs** , arrastre **SKYBOX** hasta la **vista escena**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-160">From **AppPrefabs** drag **Skybox** to the **Scene View**.</span></span>
    * <span data-ttu-id="deb4c-161">Desde **AppPrefabs** , arrastre los **administradores** a la **jerarquía**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-161">From **AppPrefabs** drag **Managers** to the **Hierarchy**.</span></span>
    * <span data-ttu-id="deb4c-162">En **AppPrefabs** , arrastre **isla** hasta la **jerarquía**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-162">From **AppPrefabs** drag **Island** to the **Hierarchy**.</span></span>
* <span data-ttu-id="deb4c-163">Guardar y compilar</span><span class="sxs-lookup"><span data-stu-id="deb4c-163">Save And build</span></span>
    * <span data-ttu-id="deb4c-164">Guardar ( **control + S** o **archivo > Guardar escena**)</span><span class="sxs-lookup"><span data-stu-id="deb4c-164">Save (either **Control+S** or **File > Save Scene**)</span></span>
    * <span data-ttu-id="deb4c-165">Dado que se trata de una nueva escena, deberá asignarle un nombre.</span><span class="sxs-lookup"><span data-stu-id="deb4c-165">Since this is a new scene, you'll need to name it.</span></span> <span data-ttu-id="deb4c-166">El nombre no importa, pero usamos SharedMixedReality.</span><span class="sxs-lookup"><span data-stu-id="deb4c-166">Name doesn't matter, but we use SharedMixedReality.</span></span>
* <span data-ttu-id="deb4c-167">Exportar a Visual Studio</span><span class="sxs-lookup"><span data-stu-id="deb4c-167">Export To Visual Studio</span></span>
    * <span data-ttu-id="deb4c-168">Abrir el menú compilar (**Control + Mayús + B** o **configuración de compilación de > de archivos**)</span><span class="sxs-lookup"><span data-stu-id="deb4c-168">Open the build menu (**Control+Shift+B** or **File > Build Settings**)</span></span>
    * <span data-ttu-id="deb4c-169">Haga clic en **Agregar escenas abiertas.**</span><span class="sxs-lookup"><span data-stu-id="deb4c-169">Click **Add Open Scenes.**</span></span>
    * <span data-ttu-id="deb4c-170">Comprobación **de C# proyectos de Unity**</span><span class="sxs-lookup"><span data-stu-id="deb4c-170">Check **Unity C# Projects**</span></span>
    * <span data-ttu-id="deb4c-171">Haz clic en **Compilación**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-171">Click **Build**.</span></span>
    * <span data-ttu-id="deb4c-172">En la ventana del explorador de archivos que aparece, cree una nueva carpeta denominada **App**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-172">In the file explorer window that appears, create a New Folder named **App**.</span></span>
    * <span data-ttu-id="deb4c-173">Haga clic en la carpeta de la **aplicación** .</span><span class="sxs-lookup"><span data-stu-id="deb4c-173">Single click the **App** folder.</span></span>
    * <span data-ttu-id="deb4c-174">Presione **Seleccionar carpeta.**</span><span class="sxs-lookup"><span data-stu-id="deb4c-174">Press **Select Folder.**</span></span>
    * <span data-ttu-id="deb4c-175">**Esperar a que se complete la compilación**</span><span class="sxs-lookup"><span data-stu-id="deb4c-175">**Wait for the build to complete**</span></span>
    * <span data-ttu-id="deb4c-176">En la ventana del explorador de archivos que aparece, navegue a la carpeta de la **aplicación** .</span><span class="sxs-lookup"><span data-stu-id="deb4c-176">In the file explorer window that appears, navigate into the **App** folder.</span></span>
    * <span data-ttu-id="deb4c-177">Haga doble clic en **SharedMixedReality. sln** para iniciar Visual Studio</span><span class="sxs-lookup"><span data-stu-id="deb4c-177">Double-click **SharedMixedReality.sln** to launch Visual Studio</span></span>
* <span data-ttu-id="deb4c-178">Compilación desde Visual Studio</span><span class="sxs-lookup"><span data-stu-id="deb4c-178">Build From Visual Studio</span></span>
    * <span data-ttu-id="deb4c-179">El uso de la barra de herramientas superior cambia el destino a **Release** y **x86**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-179">Using the top toolbar change target to **Release** and **x86**.</span></span>
    * <span data-ttu-id="deb4c-180">Haga clic en la flecha situada junto a **equipo local** y seleccione el **dispositivo** que desea implementar en HoloLens.</span><span class="sxs-lookup"><span data-stu-id="deb4c-180">Click the arrow next to **Local Machine** and select **Device** to deploy to HoloLens</span></span>
    * <span data-ttu-id="deb4c-181">Haga clic en la flecha situada junto a **dispositivo** y seleccione **equipo local** para implementar el casco de realidad mixta.</span><span class="sxs-lookup"><span data-stu-id="deb4c-181">Click the arrow next to **Device** and select **Local Machine** to deploy for the mixed reality headset.</span></span>
    * <span data-ttu-id="deb4c-182">Haga clic en depurar **-> iniciar sin** depurar o **Ctrl + F5** para iniciar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="deb4c-182">Click **Debug->Start Without Debugging** or **Control+F5** to start the application.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="deb4c-183">Profundizar en el código</span><span class="sxs-lookup"><span data-stu-id="deb4c-183">Digging into the code</span></span>

<span data-ttu-id="deb4c-184">En el panel Proyecto, desplácese a **Assets\HoloToolkit\Input\Scripts\Utilities** y haga doble clic en **MixedRealityCameraManager.CS** para abrirlo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-184">In the project panel, navigate to **Assets\HoloToolkit\Input\Scripts\Utilities** and double click **MixedRealityCameraManager.cs** to open it.</span></span>

<span data-ttu-id="deb4c-185">**Visión** MixedRealityCameraManager.cs es un script sencillo que ajusta la configuración de nivel de calidad y de fondo en función del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-185">**Overview:** MixedRealityCameraManager.cs is a simple script that adjusts quality level and background settings based on the device.</span></span> <span data-ttu-id="deb4c-186">La clave aquí es HolographicSettings. IsDisplayOpaque, que permite que un script detecte si el dispositivo es un HoloLens (IsDisplayOpaque devuelve false) o un auricular envolvente (IsDisplayOpaque devuelve true).</span><span class="sxs-lookup"><span data-stu-id="deb4c-186">Key here is HolographicSettings.IsDisplayOpaque, which allows a script to detect if the device is a HoloLens (IsDisplayOpaque returns false) or an immersive headset (IsDisplayOpaque returns true).</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="deb4c-187">Disfrute de su progreso</span><span class="sxs-lookup"><span data-stu-id="deb4c-187">Enjoy your progress</span></span>

<span data-ttu-id="deb4c-188">En este momento, la aplicación solo presentará un holograma.</span><span class="sxs-lookup"><span data-stu-id="deb4c-188">At this point the application will just render a hologram.</span></span> <span data-ttu-id="deb4c-189">Más adelante se agregará la interacción con el holograma.</span><span class="sxs-lookup"><span data-stu-id="deb4c-189">We will add interaction to the hologram later.</span></span> <span data-ttu-id="deb4c-190">Ambos dispositivos representarán el holograma.</span><span class="sxs-lookup"><span data-stu-id="deb4c-190">Both devices will render the hologram the same.</span></span> <span data-ttu-id="deb4c-191">Los auriculares inmersivo también representarán un fondo azul cielo y nubes.</span><span class="sxs-lookup"><span data-stu-id="deb4c-191">The immersive headset will also render a blue sky and clouds background.</span></span>

## <a name="chapter-2---interaction"></a><span data-ttu-id="deb4c-192">Capítulo 2: interacción</span><span class="sxs-lookup"><span data-stu-id="deb4c-192">Chapter 2 - Interaction</span></span>

>[!VIDEO https://www.youtube.com/embed/Lrb1y4sQRvI]

### <a name="objectives"></a><span data-ttu-id="deb4c-193">Objetivos</span><span class="sxs-lookup"><span data-stu-id="deb4c-193">Objectives</span></span>

<span data-ttu-id="deb4c-194">Muestra cómo controlar la entrada de una aplicación de Windows Mixed Reality.</span><span class="sxs-lookup"><span data-stu-id="deb4c-194">Show how to handle input for a Windows Mixed Reality application.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="deb4c-195">Lo que se va a crear</span><span class="sxs-lookup"><span data-stu-id="deb4c-195">What we will build</span></span>

<span data-ttu-id="deb4c-196">Al basarse en la aplicación del capítulo 1, agregaremos funcionalidad para que el usuario pueda seleccionar el holograma y colocarlo en una superficie real de HoloLens o en una tabla virtual en un casco envolvente.</span><span class="sxs-lookup"><span data-stu-id="deb4c-196">Building on the application from chapter 1, we will add functionality to allow the user to pick up the hologram and place it on a real world surface in HoloLens or on a virtual table in an immersive headset.</span></span>

<span data-ttu-id="deb4c-197">**Actualizador de entrada:** En HoloLens, el gesto de selección es la **TAP del aire**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-197">**Input Refresher:** On HoloLens the select gesture is the **air tap**.</span></span> <span data-ttu-id="deb4c-198">En los auriculares inmersivo, usaremos el botón **a** del controlador Xbox.</span><span class="sxs-lookup"><span data-stu-id="deb4c-198">On immersive headsets, we will use the **A** button on the Xbox controller.</span></span> <span data-ttu-id="deb4c-199">Para obtener más información sobre la entrada, [empiece aquí](gestures.md).</span><span class="sxs-lookup"><span data-stu-id="deb4c-199">For more information on input [start here](gestures.md).</span></span>

### <a name="steps"></a><span data-ttu-id="deb4c-200">Pasos</span><span class="sxs-lookup"><span data-stu-id="deb4c-200">Steps</span></span>
* <span data-ttu-id="deb4c-201">Agregar administrador de entrada</span><span class="sxs-lookup"><span data-stu-id="deb4c-201">Add Input manager</span></span>
    * <span data-ttu-id="deb4c-202">En **HoloToolkit > entrada > Prefabs** arrastre **InputManager** hasta **jerarquía** como elemento secundario de **Managers**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-202">From **HoloToolkit > Input > Prefabs** drag **InputManager** to **Hierarchy** as a child of **Managers**.</span></span>
    * <span data-ttu-id="deb4c-203">En **HoloToolkit > entrada > Prefabs >** **cursor de arrastre** del cursor a la **jerarquía**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-203">From **HoloToolkit > Input > Prefabs > Cursor** drag **Cursor** to **Hierarchy**.</span></span>
* <span data-ttu-id="deb4c-204">Agregar asignación espacial</span><span class="sxs-lookup"><span data-stu-id="deb4c-204">Add Spatial Mapping</span></span>
    * <span data-ttu-id="deb4c-205">En **HoloToolkit > SpatialMapping > Prefabs** arrastre **SpatialMapping** hasta **jerarquía**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-205">From **HoloToolkit > SpatialMapping > Prefabs** drag **SpatialMapping** to **Hierarchy**.</span></span>
* <span data-ttu-id="deb4c-206">Agregar Playspace virtuales</span><span class="sxs-lookup"><span data-stu-id="deb4c-206">Add Virtual Playspace</span></span>
    * <span data-ttu-id="deb4c-207">En la **jerarquía** , expanda **MixedRealityCameraParent** seleccionar **límite**</span><span class="sxs-lookup"><span data-stu-id="deb4c-207">In **Hierarchy** expand **MixedRealityCameraParent** select **Boundary**</span></span>
    * <span data-ttu-id="deb4c-208">En el panel **Inspector** , active la casilla para habilitar el **límite** .</span><span class="sxs-lookup"><span data-stu-id="deb4c-208">In **Inspector** panel check the box to enable **Boundary**</span></span>
    * <span data-ttu-id="deb4c-209">En **AppPrefabs** , arrastre **VRRoom** hasta **jerarquía**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-209">From **AppPrefabs** drag **VRRoom** to **Hierarchy**.</span></span>
* <span data-ttu-id="deb4c-210">Agregar WorldAnchorManager</span><span class="sxs-lookup"><span data-stu-id="deb4c-210">Add WorldAnchorManager</span></span>
    * <span data-ttu-id="deb4c-211">En **jerarquía**, seleccione **administradores**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-211">In **Hierarchy**, Select **Managers**.</span></span>
    * <span data-ttu-id="deb4c-212">En **Inspector**, haga clic en **Agregar componente**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-212">In **Inspector**, click **Add Component**.</span></span>
    * <span data-ttu-id="deb4c-213">Escriba **World Limit Manager**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-213">Type **World Anchor Manager**.</span></span>
    * <span data-ttu-id="deb4c-214">Seleccione **World Anchor Manager** para agregarlo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-214">Select **World Anchor Manager** to add it.</span></span>
* <span data-ttu-id="deb4c-215">Agregar TapToPlace a la isla</span><span class="sxs-lookup"><span data-stu-id="deb4c-215">Add TapToPlace to the Island</span></span>
    * <span data-ttu-id="deb4c-216">En **jerarquía**, expanda **isla**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-216">In **Hierarchy**, expand **Island**.</span></span>
    * <span data-ttu-id="deb4c-217">Seleccione **MixedRealityLand**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-217">Select **MixedRealityLand**.</span></span>
    * <span data-ttu-id="deb4c-218">En **Inspector**, haga clic en **Agregar componente**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-218">In **Inspector**, click **Add Component**.</span></span>
    * <span data-ttu-id="deb4c-219">Escriba **TAP para colocarlo** y selecciónelo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-219">Type **Tap To Place** and select it.</span></span>
    * <span data-ttu-id="deb4c-220">Active **colocar primario al pulsar**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-220">Check **Place Parent On Tap**.</span></span>
    * <span data-ttu-id="deb4c-221">Establezca **desplazamiento de selección de ubicación** en **(0, 0,1, 0)** .</span><span class="sxs-lookup"><span data-stu-id="deb4c-221">Set **Placement Offset** to **(0, 0.1, 0)**.</span></span>
* <span data-ttu-id="deb4c-222">Guardar y compilar como antes</span><span class="sxs-lookup"><span data-stu-id="deb4c-222">Save and Build as before</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="deb4c-223">Profundizar en el código</span><span class="sxs-lookup"><span data-stu-id="deb4c-223">Digging into the code</span></span>

<span data-ttu-id="deb4c-224">**Script 1: GamepadInput.cs**</span><span class="sxs-lookup"><span data-stu-id="deb4c-224">**Script 1 - GamepadInput.cs**</span></span>

<span data-ttu-id="deb4c-225">En el panel Proyecto, vaya a **Assets\HoloToolkit\Input\Scripts\InputSources** y haga doble clic en **GamepadInput.CS** para abrirlo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-225">In the project panel navigate to **Assets\HoloToolkit\Input\Scripts\InputSources** and double click **GamepadInput.cs** to open it.</span></span> <span data-ttu-id="deb4c-226">En la misma ruta de acceso del panel Proyecto, haga doble clic en **InteractionSourceInputSource.CS**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-226">From the same path in the project panel, also double click **InteractionSourceInputSource.cs**.</span></span>

<span data-ttu-id="deb4c-227">Tenga en cuenta que ambos scripts tienen una clase base común, BaseInputSource.</span><span class="sxs-lookup"><span data-stu-id="deb4c-227">Note that both scripts have a common base class, BaseInputSource.</span></span>

<span data-ttu-id="deb4c-228">BaseInputSource mantiene una referencia a un InputManager, que permite a un script desencadenar eventos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-228">BaseInputSource keeps a reference to an InputManager, which allows a script to trigger events.</span></span> <span data-ttu-id="deb4c-229">En este caso, el evento InputClicked es relevante.</span><span class="sxs-lookup"><span data-stu-id="deb4c-229">In this case, the InputClicked event is relevant.</span></span> <span data-ttu-id="deb4c-230">Esto será importante recordar cuando lleguemos al script 2, TapToPlace.</span><span class="sxs-lookup"><span data-stu-id="deb4c-230">This will be important to remember when we get to script 2, TapToPlace.</span></span> <span data-ttu-id="deb4c-231">En el caso de GamePadInput, se sondea la presencia de un botón en el controlador que se va a presionar y, a continuación, se genera el evento InputClicked.</span><span class="sxs-lookup"><span data-stu-id="deb4c-231">In the case of GamePadInput, we poll for the A button on the controller to be pressed, then we raise the InputClicked event.</span></span> <span data-ttu-id="deb4c-232">En el caso de InteractionSourceInputSource, se genera el evento InputClicked en respuesta a TappedEvent.</span><span class="sxs-lookup"><span data-stu-id="deb4c-232">In the case of InteractionSourceInputSource, we raise the InputClicked event in response to the TappedEvent.</span></span>

<span data-ttu-id="deb4c-233">**Script 2: TapToPlace.cs**</span><span class="sxs-lookup"><span data-stu-id="deb4c-233">**Script 2 - TapToPlace.cs**</span></span>

<span data-ttu-id="deb4c-234">En el panel Proyecto, vaya a **Assets\HoloToolkit\SpatialMapping\Scripts** y haga doble clic en **TapToPlace.CS** para abrirlo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-234">In the project panel navigate to **Assets\HoloToolkit\SpatialMapping\Scripts** and double click **TapToPlace.cs** to open it.</span></span>

<span data-ttu-id="deb4c-235">Lo primero que muchos desarrolladores desean implementar al crear una aplicación holográfica es mover hologramas con entrada de gestos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-235">The first thing many developers want to implement when creating a Holographic application is moving Holograms with gesture input.</span></span> <span data-ttu-id="deb4c-236">Por lo tanto, hemos hechonos comentar este script minuciosamente.</span><span class="sxs-lookup"><span data-stu-id="deb4c-236">As such, we've endeavored to thoroughly comment this script.</span></span> <span data-ttu-id="deb4c-237">Hay algunas cosas que merece la pena resaltar en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="deb4c-237">A few things are worth highlighting for this tutorial.</span></span>

<span data-ttu-id="deb4c-238">En primer lugar, tenga en cuenta que TapToPlace implementa IInputClickHandler.</span><span class="sxs-lookup"><span data-stu-id="deb4c-238">First, note that TapToPlace implements IInputClickHandler.</span></span> <span data-ttu-id="deb4c-239">IInputClickHandler expone las funciones que controlan el evento InputClicked generado por GamePadInput.cs o InteractionSourceInputSource.cs.</span><span class="sxs-lookup"><span data-stu-id="deb4c-239">IInputClickHandler exposes the functions that handle the InputClicked event raised by GamePadInput.cs or InteractionSourceInputSource.cs.</span></span> <span data-ttu-id="deb4c-240">Se llama a OnInputClicked cuando un BaseInputSource detecta un clic mientras el objeto con TapToPlace está en el foco.</span><span class="sxs-lookup"><span data-stu-id="deb4c-240">OnInputClicked is called when a BaseInputSource detects a click while the object with TapToPlace is in focus.</span></span> <span data-ttu-id="deb4c-241">Si puntea en HoloLens o si presiona el botón A del controlador Xbox, se desencadenará el evento.</span><span class="sxs-lookup"><span data-stu-id="deb4c-241">Either airtapping on HoloLens or pressing the A button on the Xbox controller will trigger the event.</span></span>

<span data-ttu-id="deb4c-242">Segundo es el código que se ejecuta en la actualización para ver si se está examinando una superficie para que podamos colocar el objeto de juego en una superficie, como una tabla.</span><span class="sxs-lookup"><span data-stu-id="deb4c-242">Second is the code be executed in update to see if a surface is being looked at so we can place the game object on a surface, like a table.</span></span> <span data-ttu-id="deb4c-243">El casco envolvente no tiene un concepto de superficies reales, por lo que el objeto que representa la tabla superior (Vroom > TableThingy > Cube) se ha marcado con la capa física SpatialMapping, por lo que la conversión de rayo en la actualización entrará en conflicto con la tabla virtual superior.</span><span class="sxs-lookup"><span data-stu-id="deb4c-243">The immersive headset doesn't have a concept of real surfaces, so the object that represents the table top (Vroom > TableThingy > Cube) has been marked with the SpatialMapping physics layer, so the ray cast in Update will collide with the virtual table top.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="deb4c-244">Disfrute de su progreso</span><span class="sxs-lookup"><span data-stu-id="deb4c-244">Enjoy your progress</span></span>

<span data-ttu-id="deb4c-245">Esta vez puede seleccionar la isla para moverla.</span><span class="sxs-lookup"><span data-stu-id="deb4c-245">This time you can select the island to move it.</span></span> <span data-ttu-id="deb4c-246">En HoloLens puede trasladar la isla a una superficie real.</span><span class="sxs-lookup"><span data-stu-id="deb4c-246">On HoloLens you can move the island to a real surface.</span></span> <span data-ttu-id="deb4c-247">En el casco envolvente puede trasladar la isla a la tabla virtual que hemos agregado.</span><span class="sxs-lookup"><span data-stu-id="deb4c-247">In the immersive headset you can move the island to the virtual table we added.</span></span>

## <a name="chapter-3---sharing"></a><span data-ttu-id="deb4c-248">Capítulo 3: compartir</span><span class="sxs-lookup"><span data-stu-id="deb4c-248">Chapter 3 - Sharing</span></span>

>[!VIDEO https://www.youtube.com/embed/1diycJvxfDc]

### <a name="objectives"></a><span data-ttu-id="deb4c-249">Objetivos</span><span class="sxs-lookup"><span data-stu-id="deb4c-249">Objectives</span></span>

<span data-ttu-id="deb4c-250">Asegúrese de que la red está configurada correctamente y detalle cómo se comparten los anclajes espaciales entre los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-250">Ensure that the network is correctly configured and detail how spatial anchors are shared between devices.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="deb4c-251">Lo que se va a crear</span><span class="sxs-lookup"><span data-stu-id="deb4c-251">What we will build</span></span>

<span data-ttu-id="deb4c-252">Convertiremos el proyecto en un proyecto de varios jugadores.</span><span class="sxs-lookup"><span data-stu-id="deb4c-252">We will convert our project to a multiplayer project.</span></span> <span data-ttu-id="deb4c-253">Agregaremos la interfaz de usuario y la lógica para hospedar o unirse a sesiones.</span><span class="sxs-lookup"><span data-stu-id="deb4c-253">We will add UI and logic to host or join sessions.</span></span> <span data-ttu-id="deb4c-254">Los usuarios de HoloLens se verán entre sí en la sesión con nubes a través de sus cabezales y los auriculares de un casco envolventes tienen nubes cerca de donde se encuentra el delimitador.</span><span class="sxs-lookup"><span data-stu-id="deb4c-254">HoloLens users will see each other in the session with clouds over their heads, and immersive headset users have clouds near to where the anchor is.</span></span> <span data-ttu-id="deb4c-255">Los usuarios de los auriculares envolventes verán los usuarios de HoloLens en relación con el origen de la escena.</span><span class="sxs-lookup"><span data-stu-id="deb4c-255">Users in the immersive headsets will see the HoloLens users relative to the origin of the scene.</span></span> <span data-ttu-id="deb4c-256">Todos los usuarios de HoloLens verán el holograma de la isla en el mismo lugar.</span><span class="sxs-lookup"><span data-stu-id="deb4c-256">HoloLens users will all see the hologram of the island in the same place.</span></span> <span data-ttu-id="deb4c-257">Es importante tener en cuenta que los usuarios de los auriculares envolventes no estarán en la isla durante este capítulo, pero se comportarán de forma similar a HoloLens, con una vista de pájaros de la isla.</span><span class="sxs-lookup"><span data-stu-id="deb4c-257">It is key to note that the users in the immersive headsets will not be on the island during this chapter, but will behave very similarly to HoloLens, with a birds eye view of the island.</span></span>

### <a name="steps"></a><span data-ttu-id="deb4c-258">Pasos</span><span class="sxs-lookup"><span data-stu-id="deb4c-258">Steps</span></span>
* <span data-ttu-id="deb4c-259">Quitar isla y VRRoom</span><span class="sxs-lookup"><span data-stu-id="deb4c-259">Remove Island and VRRoom</span></span>
    * <span data-ttu-id="deb4c-260">En **jerarquía** , haga clic con el botón derecho en **isla** seleccionar **eliminar**</span><span class="sxs-lookup"><span data-stu-id="deb4c-260">In **Hierarchy** right-click **Island** select **Delete**</span></span>
    * <span data-ttu-id="deb4c-261">En **jerarquía** , haga clic con el botón derecho en **VRRoom** seleccionar **eliminar**</span><span class="sxs-lookup"><span data-stu-id="deb4c-261">In **Hierarchy** right-click **VRRoom** select **Delete**</span></span>
* <span data-ttu-id="deb4c-262">Agregar Usland</span><span class="sxs-lookup"><span data-stu-id="deb4c-262">Add Usland</span></span>
    * <span data-ttu-id="deb4c-263">En **AppPrefabs** , arrastre **Usland** hasta **jerarquía**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-263">From **AppPrefabs** drag **Usland** to **Hierarchy**.</span></span>
* <span data-ttu-id="deb4c-264">En **AppPrefabs** , arrastre cada una de las siguientes a la **jerarquía**:</span><span class="sxs-lookup"><span data-stu-id="deb4c-264">From **AppPrefabs** drag each of the following to **Hierarchy**:</span></span>
    * <span data-ttu-id="deb4c-265">**UNETSharingStage**</span><span class="sxs-lookup"><span data-stu-id="deb4c-265">**UNETSharingStage**</span></span>
    * <span data-ttu-id="deb4c-266">**UNetAnchorRoot**</span><span class="sxs-lookup"><span data-stu-id="deb4c-266">**UNetAnchorRoot**</span></span>
    * <span data-ttu-id="deb4c-267">**UIContainer**</span><span class="sxs-lookup"><span data-stu-id="deb4c-267">**UIContainer**</span></span>
    * <span data-ttu-id="deb4c-268">**DebugPanelButton**</span><span class="sxs-lookup"><span data-stu-id="deb4c-268">**DebugPanelButton**</span></span>
* <span data-ttu-id="deb4c-269">Guardar y compilar como antes</span><span class="sxs-lookup"><span data-stu-id="deb4c-269">Save and Build as before</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="deb4c-270">Profundizar en el código</span><span class="sxs-lookup"><span data-stu-id="deb4c-270">Digging into the code</span></span>

<span data-ttu-id="deb4c-271">En el panel Proyecto, desplácese a **Assets\AppPrefabs\Support\SharingWithUnet\Scripts** y haga doble clic en **UnetAnchorManager.CS**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-271">In the project panel, navigate to **Assets\AppPrefabs\Support\SharingWithUnet\Scripts** and double-click on **UnetAnchorManager.cs**.</span></span> <span data-ttu-id="deb4c-272">La capacidad de un HoloLens de compartir información de seguimiento con otro HoloLens, de modo que ambos dispositivos puedan compartir el mismo espacio es un punto mágico.</span><span class="sxs-lookup"><span data-stu-id="deb4c-272">The ability for one HoloLens to share tracking information with another HoloLens such that both devices can share the same space is near magical.</span></span> <span data-ttu-id="deb4c-273">La eficacia de la realidad mixta se pone en conexión cuando dos o más personas pueden colaborar con los mismos datos digitales.</span><span class="sxs-lookup"><span data-stu-id="deb4c-273">The power of mixed reality comes alive when two or more people can collaborate using the same digital data.</span></span>

<span data-ttu-id="deb4c-274">Algunos aspectos que se deben señalar en este script:</span><span class="sxs-lookup"><span data-stu-id="deb4c-274">A few things to point out in this script:</span></span>

<span data-ttu-id="deb4c-275">En la función de inicio, observe la comprobación de **IsDisplayOpaque**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-275">In the start function, notice the check for **IsDisplayOpaque**.</span></span> <span data-ttu-id="deb4c-276">En este caso, supondremos que se establece el delimitador.</span><span class="sxs-lookup"><span data-stu-id="deb4c-276">In this case, we pretend that the Anchor is established.</span></span> <span data-ttu-id="deb4c-277">Esto se debe a que los auriculares envolventes no exponen una manera de importar o exportar delimitadores.</span><span class="sxs-lookup"><span data-stu-id="deb4c-277">This is because the immersive headsets do not expose a way to import or export anchors.</span></span> <span data-ttu-id="deb4c-278">Sin embargo, si se ejecuta en HoloLens, este script implementa los delimitadores de uso compartido entre los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-278">If we are running on a HoloLens, however, this script implements sharing anchors between the devices.</span></span> <span data-ttu-id="deb4c-279">El dispositivo que inicia la sesión creará un delimitador para la exportación.</span><span class="sxs-lookup"><span data-stu-id="deb4c-279">The device that starts the session will create an anchor for exporting.</span></span> <span data-ttu-id="deb4c-280">El dispositivo que se une a una sesión solicitará el delimitador del dispositivo que inició la sesión.</span><span class="sxs-lookup"><span data-stu-id="deb4c-280">The device that joins a session will request the anchor from the device that started the session.</span></span>

<span data-ttu-id="deb4c-281">**Exportador**</span><span class="sxs-lookup"><span data-stu-id="deb4c-281">**Exporting:**</span></span>

<span data-ttu-id="deb4c-282">Cuando un usuario crea una sesión, NetworkDiscoveryWithAnchors llamará a la función UNETAnchorManagers CreateAnchor.</span><span class="sxs-lookup"><span data-stu-id="deb4c-282">When a user creates a session, NetworkDiscoveryWithAnchors will call UNETAnchorManagers CreateAnchor function.</span></span> <span data-ttu-id="deb4c-283">Vamos a seguir el flujo de CreateAnchor.</span><span class="sxs-lookup"><span data-stu-id="deb4c-283">Let's follow CreateAnchor flow.</span></span>

<span data-ttu-id="deb4c-284">Comenzaremos llevando a cabo algún mantenimiento, borrando los datos que podamos haber recopilado para los delimitadores anteriores.</span><span class="sxs-lookup"><span data-stu-id="deb4c-284">We start by doing some housekeeping, clearing out any data we may have collected for previous anchors.</span></span> <span data-ttu-id="deb4c-285">A continuación, se comprueba si hay un delimitador en caché para cargar.</span><span class="sxs-lookup"><span data-stu-id="deb4c-285">Then we check if there is a cached anchor to load.</span></span> <span data-ttu-id="deb4c-286">Los datos del delimitador suelen tener entre 5 y 20 MB, por lo que reutilizar los delimitadores en caché puede ahorrar en la cantidad de datos que necesitamos transferir a través de la red.</span><span class="sxs-lookup"><span data-stu-id="deb4c-286">The anchor data tends to be between 5 and 20 MB, so reusing cached anchors can save on the amount of data we need to transfer over the network.</span></span> <span data-ttu-id="deb4c-287">Veremos cómo funciona un poco más adelante.</span><span class="sxs-lookup"><span data-stu-id="deb4c-287">We'll see how this works a bit later.</span></span> <span data-ttu-id="deb4c-288">Aunque se vuelva a usar el delimitador, es necesario que los datos del delimitador estén listos en caso de que un nuevo cliente se unan que no tenga el delimitador.</span><span class="sxs-lookup"><span data-stu-id="deb4c-288">Even if we are reusing the anchor, we need to get the anchor data ready in case a new client joins that doesn't have the anchor.</span></span>

<span data-ttu-id="deb4c-289">Hablando de la preparación de los datos de delimitador, la clase WorldAnchorTransferBatch expone la funcionalidad para preparar los datos de delimitador para el envío a otro dispositivo o aplicación y la funcionalidad para importar los datos de delimitador.</span><span class="sxs-lookup"><span data-stu-id="deb4c-289">Speaking of getting the anchor data ready, the WorldAnchorTransferBatch class exposes the functionality to prepare anchor data for sending to another device or application and the functionality to import the anchor data.</span></span> <span data-ttu-id="deb4c-290">Como estamos en la ruta de acceso de exportación, agregaremos el delimitador a WorldAnchorTransferBatch y llamaremos a la función ExportAsync.</span><span class="sxs-lookup"><span data-stu-id="deb4c-290">Since we're on the export path, we will add our anchor to the WorldAnchorTransferBatch and call the ExportAsync function.</span></span> <span data-ttu-id="deb4c-291">ExportAsync llamará a la devolución de llamada WriteBuffer a medida que genera datos para la exportación.</span><span class="sxs-lookup"><span data-stu-id="deb4c-291">ExportAsync will then call the WriteBuffer callback as it generates data for export.</span></span> <span data-ttu-id="deb4c-292">Cuando todos los datos se hayan exportado, se llamará a ExportComplete.</span><span class="sxs-lookup"><span data-stu-id="deb4c-292">When all of the data has been exported ExportComplete will be called.</span></span> <span data-ttu-id="deb4c-293">En WriteBuffer, se agrega el fragmento de datos a una lista que se conserva para la exportación.</span><span class="sxs-lookup"><span data-stu-id="deb4c-293">In WriteBuffer we add the chunk of data to a list we keep for exporting.</span></span> <span data-ttu-id="deb4c-294">En ExportComplete, la lista se convierte en una matriz.</span><span class="sxs-lookup"><span data-stu-id="deb4c-294">In ExportComplete we convert the list to an array.</span></span> <span data-ttu-id="deb4c-295">También se establece la variable AnchorName, que desencadenará que otros dispositivos soliciten el delimitador si no lo tienen.</span><span class="sxs-lookup"><span data-stu-id="deb4c-295">The AnchorName variable is also set, which will trigger other devices to request the anchor if they don't have it.</span></span>

<span data-ttu-id="deb4c-296">En algunos casos, el anclaje no se exportará o creará demasiados datos que se volverán a intentar.</span><span class="sxs-lookup"><span data-stu-id="deb4c-296">In some cases the anchor won't export or will create so little data that we will try again.</span></span> <span data-ttu-id="deb4c-297">Aquí simplemente llamaremos a CreateAnchor de nuevo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-297">Here we just call CreateAnchor again.</span></span>

<span data-ttu-id="deb4c-298">Una función final de la ruta de acceso de exportación es AnchorFoundRemotely.</span><span class="sxs-lookup"><span data-stu-id="deb4c-298">A final function in the export path is AnchorFoundRemotely.</span></span> <span data-ttu-id="deb4c-299">Cuando otro dispositivo encuentra el delimitador, ese dispositivo indicará al host y el host lo usará como señal de que el delimitador es un "buen anclaje" y se puede almacenar en caché.</span><span class="sxs-lookup"><span data-stu-id="deb4c-299">When another device finds the anchor, that device will tell the host, and the host will use that as a signal that the anchor is a "good anchor" and can be cached.</span></span>

<span data-ttu-id="deb4c-300">**Importa**</span><span class="sxs-lookup"><span data-stu-id="deb4c-300">**Importing:**</span></span>

<span data-ttu-id="deb4c-301">Cuando una HoloLens se une a una sesión, debe importar un delimitador.</span><span class="sxs-lookup"><span data-stu-id="deb4c-301">When a HoloLens joins a session, it needs to import an anchor.</span></span> <span data-ttu-id="deb4c-302">En la función de actualización de UNETAnchorManager, el AnchorName se sondea.</span><span class="sxs-lookup"><span data-stu-id="deb4c-302">In UNETAnchorManager's Update function, the AnchorName is polled.</span></span> <span data-ttu-id="deb4c-303">Cuando cambia el nombre del delimitador, comienza el proceso de importación.</span><span class="sxs-lookup"><span data-stu-id="deb4c-303">When the anchor name changes, the import process begins.</span></span> <span data-ttu-id="deb4c-304">En primer lugar, se intenta cargar el delimitador con el nombre especificado desde el almacén de delimitadores local.</span><span class="sxs-lookup"><span data-stu-id="deb4c-304">First, we try to load the anchor with the specified name from the local anchor store.</span></span> <span data-ttu-id="deb4c-305">Si ya lo tenemos, podemos usarlo sin descargar los datos de nuevo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-305">If we already have it, we can use it without downloading the data again.</span></span> <span data-ttu-id="deb4c-306">Si no lo tenemos, llamamos a WaitForAnchor, que iniciará la descarga.</span><span class="sxs-lookup"><span data-stu-id="deb4c-306">If we don't have it, then we call WaitForAnchor which will initiate the download.</span></span>

<span data-ttu-id="deb4c-307">Una vez completada la descarga, se llama a NetworkTransmitter_dataReadyEvent.</span><span class="sxs-lookup"><span data-stu-id="deb4c-307">When the download is completed, NetworkTransmitter_dataReadyEvent is called.</span></span> <span data-ttu-id="deb4c-308">Esto indicará al bucle de actualización que llame a ImportAsync con los datos descargados.</span><span class="sxs-lookup"><span data-stu-id="deb4c-308">This will signal the Update loop to call ImportAsync with the downloaded data.</span></span> <span data-ttu-id="deb4c-309">ImportAsync llamará a ImportComplete cuando se complete el proceso de importación.</span><span class="sxs-lookup"><span data-stu-id="deb4c-309">ImportAsync will call ImportComplete when the import process is complete.</span></span> <span data-ttu-id="deb4c-310">Si la importación se realiza correctamente, el delimitador se guardará en el almacén del reproductor local.</span><span class="sxs-lookup"><span data-stu-id="deb4c-310">If the import is successful, the anchor will be saved in the local player store.</span></span> <span data-ttu-id="deb4c-311">PlayerController.cs realmente realiza la llamada a AnchorFoundRemotely para que el host sepa que se ha establecido un buen anclaje.</span><span class="sxs-lookup"><span data-stu-id="deb4c-311">PlayerController.cs actually makes the call to AnchorFoundRemotely to let the host know that a good anchor has been established.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="deb4c-312">Disfrute de su progreso</span><span class="sxs-lookup"><span data-stu-id="deb4c-312">Enjoy your progress</span></span>

<span data-ttu-id="deb4c-313">Esta vez, un usuario con HoloLens hospedará una sesión mediante el botón **iniciar sesión** en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="deb4c-313">This time a user with a HoloLens will host a session using the **start session** button in the UI.</span></span> <span data-ttu-id="deb4c-314">Otros usuarios, tanto en HoloLens como en un casco envolvente, seleccionarán la sesión y, después, seleccionarán el botón unirse a la **sesión** en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="deb4c-314">Other users, both on HoloLens or an immersive headset, will select the session and then select the **join session** button in the UI.</span></span> <span data-ttu-id="deb4c-315">Si tiene varias personas con dispositivos HoloLens, tendrán nubes rojas sobre sus cabezales.</span><span class="sxs-lookup"><span data-stu-id="deb4c-315">If you have multiple people with HoloLens devices, they will have red clouds over their heads.</span></span> <span data-ttu-id="deb4c-316">También habrá una nube azul para cada casco envolvente, pero las nubes azules no estarán por encima de los auriculares, ya que los auriculares no intentan encontrar el mismo espacio de coordenadas universal que los dispositivos HoloLens.</span><span class="sxs-lookup"><span data-stu-id="deb4c-316">There will also be a blue cloud for each immersive headset, but the blue clouds will not be above the headsets, as the headsets are not trying to find the same world coordinate space as the HoloLens devices.</span></span>

<span data-ttu-id="deb4c-317">Este punto del proyecto es una aplicación de uso compartido independiente; no hace mucho y podría actuar como línea base.</span><span class="sxs-lookup"><span data-stu-id="deb4c-317">This point in the project is a contained sharing application; it doesn't do very much, and could act as a baseline.</span></span> <span data-ttu-id="deb4c-318">En los capítulos siguientes comenzaremos a crear una experiencia para que los usuarios disfruten.</span><span class="sxs-lookup"><span data-stu-id="deb4c-318">In the next chapters, we will start building an experience for people to enjoy.</span></span> <span data-ttu-id="deb4c-319">Para obtener más información sobre el diseño de la experiencia compartida, vaya aquí.</span><span class="sxs-lookup"><span data-stu-id="deb4c-319">To get further guidance on shared experience design, go here.</span></span>

## <a name="chapter-4---immersion-and-teleporting"></a><span data-ttu-id="deb4c-320">Capítulo 4: inmersión y teletraslado</span><span class="sxs-lookup"><span data-stu-id="deb4c-320">Chapter 4 - Immersion and teleporting</span></span>

>[!VIDEO https://www.youtube.com/embed/kUHZ5tCOfvY]

### <a name="objectives"></a><span data-ttu-id="deb4c-321">Objetivos</span><span class="sxs-lookup"><span data-stu-id="deb4c-321">Objectives</span></span>

<span data-ttu-id="deb4c-322">Disfrute de la experiencia en cada tipo de dispositivo de realidad mixta.</span><span class="sxs-lookup"><span data-stu-id="deb4c-322">Cater the experience to each type of mixed reality device.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="deb4c-323">Lo que se va a crear</span><span class="sxs-lookup"><span data-stu-id="deb4c-323">What we will build</span></span>

<span data-ttu-id="deb4c-324">Actualizaremos la aplicación para poner a los usuarios con auriculares envolvente en la isla con una vista envolvente.</span><span class="sxs-lookup"><span data-stu-id="deb4c-324">We will update the application to put immersive headset users on the island with an immersive view.</span></span> <span data-ttu-id="deb4c-325">Los usuarios de HoloLens seguirán teniendo la vista de pájaro de la isla.</span><span class="sxs-lookup"><span data-stu-id="deb4c-325">HoloLens users will still have the bird's eye view of the island.</span></span> <span data-ttu-id="deb4c-326">Los usuarios de cada tipo de dispositivo pueden ver a otros usuarios a medida que aparecen en el mundo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-326">Users of each device type can see other users as they appear in the world.</span></span> <span data-ttu-id="deb4c-327">Por ejemplo, los auriculares envolventes pueden ver los demás avatares en otras rutas de acceso de la isla y ven a los usuarios de HoloLens como nubes gigantes por encima de la isla.</span><span class="sxs-lookup"><span data-stu-id="deb4c-327">For instance, immersive headset users can see the other avatars on other paths on the island, and they see the HoloLens users as giant clouds above the island.</span></span> <span data-ttu-id="deb4c-328">Los auriculares envolventes también verán el cursor del rayo fijamente del usuario de HoloLens si el usuario de HoloLens mira la isla.</span><span class="sxs-lookup"><span data-stu-id="deb4c-328">Immersive headset users will also see the cursor of the HoloLens user's gaze ray if the HoloLens user is looking at the island.</span></span> <span data-ttu-id="deb4c-329">Los usuarios de HoloLens verán un avatar en la isla para representar cada usuario de auriculares envolvente.</span><span class="sxs-lookup"><span data-stu-id="deb4c-329">HoloLens users will see an avatar on the island to represent each immersive headset user.</span></span>

<span data-ttu-id="deb4c-330">**Entrada actualizada para el dispositivo envolvente:**</span><span class="sxs-lookup"><span data-stu-id="deb4c-330">**Updated Input for the Immersive device:**</span></span>
* <span data-ttu-id="deb4c-331">Los botones del parachoques izquierdo y derecho del controlador Xbox giran el reproductor</span><span class="sxs-lookup"><span data-stu-id="deb4c-331">The left bumper and right bumper buttons on the Xbox controller rotate the player</span></span>
* <span data-ttu-id="deb4c-332">Si mantiene presionado el botón Y en el controlador de Xbox, se habilitará un cursor [teletranspórtate](navigating-the-windows-mixed-reality-home.md#getting-around-your-home) .</span><span class="sxs-lookup"><span data-stu-id="deb4c-332">Holding the Y button on the Xbox controller will enable a [teleport](navigating-the-windows-mixed-reality-home.md#getting-around-your-home) cursor.</span></span> <span data-ttu-id="deb4c-333">Si el cursor tiene un indicador de flecha giratoria al soltar el botón Y, se teletransporta a la ubicación del cursor.</span><span class="sxs-lookup"><span data-stu-id="deb4c-333">If the cursor has a spinning arrow indicator when you release the Y button, you will be teleported to the cursor's location.</span></span>

### <a name="steps"></a><span data-ttu-id="deb4c-334">Pasos</span><span class="sxs-lookup"><span data-stu-id="deb4c-334">Steps</span></span>
* <span data-ttu-id="deb4c-335">Agregar MixedRealityTeleport a MixedRealityCameraParent</span><span class="sxs-lookup"><span data-stu-id="deb4c-335">Add MixedRealityTeleport to MixedRealityCameraParent</span></span>
    * <span data-ttu-id="deb4c-336">En **jerarquía**, seleccione **Usland**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-336">In **Hierarchy**, select **Usland**.</span></span>
    * <span data-ttu-id="deb4c-337">En **Inspector**, habilite el **control de nivel**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-337">In **Inspector**, enable **Level Control**.</span></span>
    * <span data-ttu-id="deb4c-338">En **jerarquía**, seleccione **MixedRealityCameraParent**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-338">In **Hierarchy**, select **MixedRealityCameraParent**.</span></span>
    * <span data-ttu-id="deb4c-339">En **Inspector**, haga clic en **Agregar componente**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-339">In **Inspector**, click **Add Component**.</span></span>
    * <span data-ttu-id="deb4c-340">Escriba la **realidad mixta teletranspórtate** y selecciónela.</span><span class="sxs-lookup"><span data-stu-id="deb4c-340">Type **Mixed Reality Teleport** and select it.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="deb4c-341">Profundizar en el código</span><span class="sxs-lookup"><span data-stu-id="deb4c-341">Digging into the code</span></span>

<span data-ttu-id="deb4c-342">Los auriculares envolventes se anclarán a sus equipos con cable, pero nuestra isla es mayor que el cable es largo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-342">Immersive headset users will be tethered to their PCs with a cable, but our island is larger than the cable is long.</span></span> <span data-ttu-id="deb4c-343">Para compensar, necesitamos la capacidad de trasladar la cámara independientemente del movimiento del usuario.</span><span class="sxs-lookup"><span data-stu-id="deb4c-343">To compensate, we need the ability to move the camera independently of the user's motion.</span></span> <span data-ttu-id="deb4c-344">Vea la [Página de confort](comfort.md) para obtener más información sobre el diseño de la aplicación de realidad mixta (en particular, Automotion y Locomotion).</span><span class="sxs-lookup"><span data-stu-id="deb4c-344">Please see the [comfort page](comfort.md) for more information about designing your mixed reality application (in particular self motion and locomotion).</span></span>

<span data-ttu-id="deb4c-345">Para describir este proceso, será útil definir dos términos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-345">In order to describe this process it will be useful to define two terms.</span></span> <span data-ttu-id="deb4c-346">En primer lugar, **Dolly** será el objeto que mueve la cámara independientemente del usuario.</span><span class="sxs-lookup"><span data-stu-id="deb4c-346">First, **dolly** will be the object that moves the camera independently from the user.</span></span> <span data-ttu-id="deb4c-347">Un objeto de juego secundario de **Dolly** será la **cámara principal**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-347">A child game object of the **dolly** will be the **main camera**.</span></span> <span data-ttu-id="deb4c-348">La cámara principal se adjunta al encabezado del usuario.</span><span class="sxs-lookup"><span data-stu-id="deb4c-348">The main camera is attached to the user's head.</span></span>

<span data-ttu-id="deb4c-349">En el panel Proyecto, desplácese a **Assets\AppPrefabs\Support\Scripts\GameLogic** y haga doble clic en **MixedRealityTeleport.CS**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-349">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **MixedRealityTeleport.cs**.</span></span>

<span data-ttu-id="deb4c-350">MixedRealityTeleport tiene dos trabajos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-350">MixedRealityTeleport has two jobs.</span></span> <span data-ttu-id="deb4c-351">En primer lugar, controla la rotación mediante los reboteadores.</span><span class="sxs-lookup"><span data-stu-id="deb4c-351">First, it handles rotation using the bumpers.</span></span> <span data-ttu-id="deb4c-352">En la función de actualización, se sondea "ButtonUp" en LeftBumper y RightBumper.</span><span class="sxs-lookup"><span data-stu-id="deb4c-352">In the update function we poll for 'ButtonUp' on LeftBumper and RightBumper.</span></span> <span data-ttu-id="deb4c-353">GetButtonUp solo devuelve true en el primer fotograma en el que se encuentra un botón después de haber estado inactivo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-353">GetButtonUp only returns true on the first frame a button is up after having been down.</span></span> <span data-ttu-id="deb4c-354">Si se ha producido algún botón, sabemos que el usuario necesita girar.</span><span class="sxs-lookup"><span data-stu-id="deb4c-354">If either button had been raised, then we know the user needs to rotate.</span></span>

<span data-ttu-id="deb4c-355">Cuando giramos, hacemos un fundido y atenúan el uso de un script simple denominado ' Desvanecer control '.</span><span class="sxs-lookup"><span data-stu-id="deb4c-355">When we rotate we do a fade out and fade in using a simple script called 'fade control'.</span></span> <span data-ttu-id="deb4c-356">Hacemos esto para evitar que el usuario vea un movimiento no natural que podría dar lugar a molestias.</span><span class="sxs-lookup"><span data-stu-id="deb4c-356">We do this to prevent the user from seeing an unnatural movement which could lead to discomfort.</span></span> <span data-ttu-id="deb4c-357">Los efectos de fundido y salida son bastante sencillos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-357">The fade in and out effect is fairly simple.</span></span> <span data-ttu-id="deb4c-358">Tenemos un fondo negro en la parte delantera de la **cámara principal**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-358">We have a black quad hanging in front of the **main camera**.</span></span> <span data-ttu-id="deb4c-359">Cuando se atenúa, se pasa el valor alfa de 0 a 1.</span><span class="sxs-lookup"><span data-stu-id="deb4c-359">When fading out we transition the alpha value from 0 to 1.</span></span> <span data-ttu-id="deb4c-360">Esto hace que los píxeles negros de la cuádruple se representen y oculten todo lo que quede detrás.</span><span class="sxs-lookup"><span data-stu-id="deb4c-360">This gradually causes the black pixels of the quad to render and obscure anything behind them.</span></span> <span data-ttu-id="deb4c-361">Al retroceder en, la transición del valor alfa vuelve a ser cero.</span><span class="sxs-lookup"><span data-stu-id="deb4c-361">When fading back in we transition the alpha value back to zero.</span></span>

<span data-ttu-id="deb4c-362">Al calcular la rotación, tenga en cuenta que estamos rotando nuestro **Dolly** pero calculando el giro alrededor de la **cámara principal**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-362">When we calculate the rotation, note that we are rotating our **dolly** but calculating the rotation around the **main camera**.</span></span> <span data-ttu-id="deb4c-363">Esto es importante, ya que el más alejado de la **cámara principal** está fuera de 0, 0, 0, con menos precisión un giro alrededor de la Dolly se pasaría del punto de vista del usuario.</span><span class="sxs-lookup"><span data-stu-id="deb4c-363">This is important as the farther the **main camera** is away from 0,0,0, the less accurate a rotation around the dolly would become from the point of view of the user.</span></span> <span data-ttu-id="deb4c-364">De hecho, si no gira alrededor de la posición de la cámara, el usuario se desplazará por el **Dolly** en lugar de girar.</span><span class="sxs-lookup"><span data-stu-id="deb4c-364">In fact, if you do not rotate around the camera position, the user will move on an arc around the **dolly** rather than rotating.</span></span>

<span data-ttu-id="deb4c-365">El segundo trabajo para MixedRealityTeleport es controlar el movimiento de **Dolly**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-365">The second job for MixedRealityTeleport is to handle moving the **dolly**.</span></span> <span data-ttu-id="deb4c-366">Esto se hace en SetWorldPosition.</span><span class="sxs-lookup"><span data-stu-id="deb4c-366">This is done in SetWorldPosition.</span></span> <span data-ttu-id="deb4c-367">SetWorldPosition toma la posición mundial deseada, la posición en la que el usuario desea percieve que inhabit.</span><span class="sxs-lookup"><span data-stu-id="deb4c-367">SetWorldPosition takes the desired world position, the position where the user wants to percieve that they inhabit.</span></span> <span data-ttu-id="deb4c-368">Necesitamos colocar el **Dolly** en esa posición menos la posición local de la **cámara principal**, ya que ese desplazamiento se agregará a cada fotograma.</span><span class="sxs-lookup"><span data-stu-id="deb4c-368">We need to put our **dolly** at that position minus the local position of the **main camera**, as that offset will be added each frame.</span></span>

<span data-ttu-id="deb4c-369">Un segundo script llama a SetWorldPosition.</span><span class="sxs-lookup"><span data-stu-id="deb4c-369">A second script calls SetWorldPosition.</span></span> <span data-ttu-id="deb4c-370">Echemos un vistazo a ese script.</span><span class="sxs-lookup"><span data-stu-id="deb4c-370">Let's look at that script.</span></span> <span data-ttu-id="deb4c-371">En el panel Proyecto, desplácese a **Assets\AppPrefabs\Support\Scripts\GameLogic** y haga doble clic en **TeleportScript.CS**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-371">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **TeleportScript.cs**.</span></span>

<span data-ttu-id="deb4c-372">Este script es un poco más complicado que MixedRealityTeleport.</span><span class="sxs-lookup"><span data-stu-id="deb4c-372">This script is a little more involved than MixedRealityTeleport.</span></span> <span data-ttu-id="deb4c-373">El script está comprobando si el botón Y del controlador Xbox debe mantenerse inactivo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-373">The script is checking for the Y Button on the Xbox controller to be held down.</span></span> <span data-ttu-id="deb4c-374">Mientras se mantiene presionado el botón, se representa un cursor teletranspórtate y el script convierte un rayo de la posición de AvPág del usuario.</span><span class="sxs-lookup"><span data-stu-id="deb4c-374">While the button is held down a teleport cursor is rendered and the script casts a ray from the user's gaze position.</span></span> <span data-ttu-id="deb4c-375">Si ese rayo entra en conflicto con una superficie que señala más o menos, se considerará que la superficie es una buena superficie para teletranspórtate y se habilitará la animación en el cursor teletranspórtate.</span><span class="sxs-lookup"><span data-stu-id="deb4c-375">If that ray collides with a surface that is more or less pointing up, the surface will be considered a good surface to teleport to, and the animation on the teleport cursor will be enabled.</span></span> <span data-ttu-id="deb4c-376">Si el rayo no entra en conflicto con una superficie más o menos apuntando, se deshabilitará la animación del cursor.</span><span class="sxs-lookup"><span data-stu-id="deb4c-376">If the ray does not collide with a surface more or less pointing up, then the animation on the cursor will be disabled.</span></span> <span data-ttu-id="deb4c-377">Cuando se suelta el botón y y el punto calculado del rayo es una posición válida, el script llama a SetWorldPosition con la posición en la que se intersecó el rayo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-377">When the Y button is released and the calculated point of the ray is a valid position, the script calls SetWorldPosition with the position the ray intersected.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="deb4c-378">Disfrute de su progreso</span><span class="sxs-lookup"><span data-stu-id="deb4c-378">Enjoy your progress</span></span>

<span data-ttu-id="deb4c-379">Esta vez necesitará encontrar un amigo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-379">This time you'll need to find a friend.</span></span>

<span data-ttu-id="deb4c-380">Una vez más, un usuario con HoloLens hospedará una sesión.</span><span class="sxs-lookup"><span data-stu-id="deb4c-380">Once again, a user with the HoloLens will host a session.</span></span> <span data-ttu-id="deb4c-381">Otros usuarios se unirán a la sesión.</span><span class="sxs-lookup"><span data-stu-id="deb4c-381">Other users will join the session.</span></span> <span data-ttu-id="deb4c-382">La aplicación colocará los tres primeros usuarios para unirse desde un casco inmersivo en una de las tres rutas de acceso de la isla.</span><span class="sxs-lookup"><span data-stu-id="deb4c-382">The application will place the first three users to join from an immersive headset on one of the three paths on the island.</span></span> <span data-ttu-id="deb4c-383">No dude en explorar la isla en esta sección.</span><span class="sxs-lookup"><span data-stu-id="deb4c-383">Feel free to explore the island in this section.</span></span>

<span data-ttu-id="deb4c-384">Detalles que se deben tener en cuenta:</span><span class="sxs-lookup"><span data-stu-id="deb4c-384">Details to notice:</span></span>
1. <span data-ttu-id="deb4c-385">Puede ver caras en las nubes, lo que ayuda a un usuario sumergido a ver la dirección que está buscando un usuario de HoloLens.</span><span class="sxs-lookup"><span data-stu-id="deb4c-385">You can see faces in the clouds, which helps an immersed user see which direction a HoloLens user is looking.</span></span>
2. <span data-ttu-id="deb4c-386">Los avatares de la isla tienen cuellos que giran.</span><span class="sxs-lookup"><span data-stu-id="deb4c-386">The avatars on the island have necks that rotate.</span></span> <span data-ttu-id="deb4c-387">No se van a seguir lo que el usuario está haciendo es realidad real (no tenemos esa información), pero es una buena experiencia.</span><span class="sxs-lookup"><span data-stu-id="deb4c-387">They won't follow what the user is doing is real reality (we don't have that information) but it makes for a nice experience.</span></span>
3. <span data-ttu-id="deb4c-388">Si el usuario de HoloLens mira la isla, los usuarios sumergidos pueden ver su cursor.</span><span class="sxs-lookup"><span data-stu-id="deb4c-388">If the HoloLens user is looking at the Island, the immersed users can see their cursor.</span></span>
4. <span data-ttu-id="deb4c-389">Las nubes que representan a los usuarios de HoloLens proyectan sombras.</span><span class="sxs-lookup"><span data-stu-id="deb4c-389">The clouds that represent the HoloLens users cast shadows.</span></span>

## <a name="chapter-5---finale"></a><span data-ttu-id="deb4c-390">Capítulo 5: finalización</span><span class="sxs-lookup"><span data-stu-id="deb4c-390">Chapter 5 - Finale</span></span>

>[!VIDEO https://www.youtube.com/embed/n_HDWJbfpNg]

### <a name="objectives"></a><span data-ttu-id="deb4c-391">Objetivos</span><span class="sxs-lookup"><span data-stu-id="deb4c-391">Objectives</span></span>

<span data-ttu-id="deb4c-392">Cree una experiencia interactiva colaborativa entre los dos tipos de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="deb4c-392">Create a collaborative interactive experience between the two device types.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="deb4c-393">Lo que se va a crear</span><span class="sxs-lookup"><span data-stu-id="deb4c-393">What we will build</span></span>

<span data-ttu-id="deb4c-394">Basándose en el capítulo 4, cuando un usuario con un casco envolvente se acerque a un rompecabezas de la isla, los usuarios de HoloLens obtendrán una información sobre herramientas con una pista sobre el rompecabezas.</span><span class="sxs-lookup"><span data-stu-id="deb4c-394">Building on chapter 4, when a user with an immersive headset gets near a puzzle on the island, the HoloLens users will get a tool tip with a clue to the puzzle.</span></span> <span data-ttu-id="deb4c-395">Una vez que todos los auriculares envolventes se colocan por encima de sus rompecabezas y en el "panel listo" del salón, se lanzará el cohete.</span><span class="sxs-lookup"><span data-stu-id="deb4c-395">Once all of the immersive headset users get past their puzzles and onto the "ready pad" in the rocket room, the rocket will launch.</span></span>

### <a name="steps"></a><span data-ttu-id="deb4c-396">Pasos</span><span class="sxs-lookup"><span data-stu-id="deb4c-396">Steps</span></span>
* <span data-ttu-id="deb4c-397">En **jerarquía**, seleccione **Usland**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-397">In **Hierarchy**, select **Usland**.</span></span>
* <span data-ttu-id="deb4c-398">En **Inspector**, en **control de nivel**, Active **Habilitar colaboración**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-398">In **Inspector**, in **Level Control**, check **Enable Collaboration**.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="deb4c-399">Profundizar en el código</span><span class="sxs-lookup"><span data-stu-id="deb4c-399">Digging into the code</span></span>

<span data-ttu-id="deb4c-400">Ahora, echemos un vistazo a LevelControl.cs.</span><span class="sxs-lookup"><span data-stu-id="deb4c-400">Now let us look at LevelControl.cs.</span></span> <span data-ttu-id="deb4c-401">Este script es el núcleo de la lógica del juego y mantiene el estado del juego.</span><span class="sxs-lookup"><span data-stu-id="deb4c-401">This script is the core of the game logic and maintains the game state.</span></span> <span data-ttu-id="deb4c-402">Dado que se trata de un juego multijugador que usa UNET, necesitamos comprender cómo fluyen los datos, al menos lo suficientemente bien como para modificar este tutorial.</span><span class="sxs-lookup"><span data-stu-id="deb4c-402">Since this is a multiplayer game using UNET we need to understand how data flows, at least well enough to modify this tutorial.</span></span> <span data-ttu-id="deb4c-403">Para obtener una introducción más completa de UNET, consulte la documentación de Unity.</span><span class="sxs-lookup"><span data-stu-id="deb4c-403">For a more complete overview of UNET, please refer to Unity's documentation.</span></span>

<span data-ttu-id="deb4c-404">En el panel Proyecto, desplácese a **Assets\AppPrefabs\Support\Scripts\GameLogic** y haga doble clic en **LevelControl.CS**.</span><span class="sxs-lookup"><span data-stu-id="deb4c-404">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **LevelControl.cs**.</span></span>

<span data-ttu-id="deb4c-405">Vamos a entender cómo un casco inmersivo indica que están preparados para el lanzamiento de Rocket.</span><span class="sxs-lookup"><span data-stu-id="deb4c-405">Let us understand how an immersive headset indicates that they are ready for the rocket launch.</span></span> <span data-ttu-id="deb4c-406">Rocket Launch Readiness se comunica mediante la configuración de uno de los tres booleanos de una lista de bool que corresponden a las tres rutas de acceso de la isla.</span><span class="sxs-lookup"><span data-stu-id="deb4c-406">Rocket Launch readiness is communicated by setting one of three bools in a list of bools that correspond to the three paths on the island.</span></span> <span data-ttu-id="deb4c-407">El valor booleano de una ruta de acceso se establecerá cuando el usuario asignado a la ruta de acceso se encuentre en la parte superior del panel marrón dentro de la habitación.</span><span class="sxs-lookup"><span data-stu-id="deb4c-407">A path's bool will be set when the user assigned to the path is on top of the brown pad inside the rocket room.</span></span> <span data-ttu-id="deb4c-408">Bien, ahora a los detalles.</span><span class="sxs-lookup"><span data-stu-id="deb4c-408">Okay, now to the details.</span></span>

<span data-ttu-id="deb4c-409">Comenzaremos en la función Update ().</span><span class="sxs-lookup"><span data-stu-id="deb4c-409">We will start in the Update() function.</span></span> <span data-ttu-id="deb4c-410">Observará que hay una función de "trampa".</span><span class="sxs-lookup"><span data-stu-id="deb4c-410">You will note that there is a 'cheat' function.</span></span> <span data-ttu-id="deb4c-411">Lo usamos en desarrollo para probar la secuencia de inicio y restablecimiento de Rocket.</span><span class="sxs-lookup"><span data-stu-id="deb4c-411">We used this in development to test the rocket launch and reset sequence.</span></span> <span data-ttu-id="deb4c-412">No funcionará en la experiencia de varios usuarios.</span><span class="sxs-lookup"><span data-stu-id="deb4c-412">It won't work in the multi user experience.</span></span> <span data-ttu-id="deb4c-413">Afortunadamente, en el momento en que internalizar la siguiente desactivación, puede hacer que funcione.</span><span class="sxs-lookup"><span data-stu-id="deb4c-413">Hopefully by the time you internalize the following infromation you can make it work.</span></span> <span data-ttu-id="deb4c-414">Después de comprobar si debemos hacernos trampas, comprobamos si el reproductor local está sumergido.</span><span class="sxs-lookup"><span data-stu-id="deb4c-414">After we check to see if we should cheat, we check to see if the local player is immersed.</span></span> <span data-ttu-id="deb4c-415">Queremos centrarnos en cómo encontramos que estamos en el objetivo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-415">We want to focus on how we find that we're at the goal.</span></span> <span data-ttu-id="deb4c-416">Dentro de la comprobación if (sumergida), hay una llamada a CheckGoal que oculta detrás de **EnableCollaboration** bool.</span><span class="sxs-lookup"><span data-stu-id="deb4c-416">Inside of the if (Immersed) check, there is a call to CheckGoal hiding behind the **EnableCollaboration** bool.</span></span> <span data-ttu-id="deb4c-417">Esto corresponde a la casilla que activó al completar los pasos de este capítulo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-417">This corresponds to the checkbox you checked while completing the steps for this chapter.</span></span> <span data-ttu-id="deb4c-418">Dentro de EnableCollaboration, vemos una llamada a CheckGoal ().</span><span class="sxs-lookup"><span data-stu-id="deb4c-418">Inside of EnableCollaboration we see a call to CheckGoal().</span></span>

<span data-ttu-id="deb4c-419">CheckGoal realiza algunas operaciones matemáticas para ver si estamos más o menos en el panel.</span><span class="sxs-lookup"><span data-stu-id="deb4c-419">CheckGoal does some math to see if we are more or less standing on the pad.</span></span> <span data-ttu-id="deb4c-420">Cuando somos, depure. log "llegó en el objetivo" y, a continuación, llamamos a "SendAtGoalMessage ()".</span><span class="sxs-lookup"><span data-stu-id="deb4c-420">When we are, we Debug.Log "Arrived at goal" and then we call 'SendAtGoalMessage()'.</span></span> <span data-ttu-id="deb4c-421">En SendAtGoalMessage se llama a playerController. SendAtGoal.</span><span class="sxs-lookup"><span data-stu-id="deb4c-421">In SendAtGoalMessage we call playerController.SendAtGoal.</span></span> <span data-ttu-id="deb4c-422">Para ahorrar tiempo, este es el código:</span><span class="sxs-lookup"><span data-stu-id="deb4c-422">To save you some time, here's the code:</span></span>

```cs
private void CmdSendAtGoal(int GoalIndex)
       {
           levelState.SetGoalIndex(GoalIndex);
       }
```

```cs
public void SendAtGoal(int GoalIndex)
       {
           if (isLocalPlayer)
           {
               Debug.Log("sending at goal " + GoalIndex);
               CmdSendAtGoal(GoalIndex);
           }
       }
```

<span data-ttu-id="deb4c-423">Tenga en cuenta que SendAtGoalMessage llama a CmdSendAtGoal, que llama a levelState. SetGoalIndex, que vuelve a LevelControl.cs.</span><span class="sxs-lookup"><span data-stu-id="deb4c-423">Note that SendAtGoalMessage calls CmdSendAtGoal, which calls levelState.SetGoalIndex, which is back in LevelControl.cs.</span></span> <span data-ttu-id="deb4c-424">A primera vista, parece extraño.</span><span class="sxs-lookup"><span data-stu-id="deb4c-424">At first glance this seems strange.</span></span> <span data-ttu-id="deb4c-425">¿Por qué no simplemente llamar a SetGoalIndex en lugar de a este enrutamiento extraño a través del controlador del reproductor?</span><span class="sxs-lookup"><span data-stu-id="deb4c-425">Why not just call SetGoalIndex rather than this strange routing through the player controller?</span></span> <span data-ttu-id="deb4c-426">La razón es que estamos conformes al modelo de datos que UNET usa para mantener los datos sincronizados. Para evitar la mejora y la paginación, UNET requiere que cada objeto tenga un usuario que tenga autoridad para cambiar las variables sincronizadas.</span><span class="sxs-lookup"><span data-stu-id="deb4c-426">The reason is that we are conforming to the data model UNET uses to keep data in sync. To prevent cheating and thrashing, UNET requires that each object has a user who has authority to change the synchronized variables.</span></span> <span data-ttu-id="deb4c-427">Además, solo el host (el usuario que inició la sesión) puede cambiar los datos directamente.</span><span class="sxs-lookup"><span data-stu-id="deb4c-427">Further, only the host (the user that started the session) can change data directly.</span></span> <span data-ttu-id="deb4c-428">Los usuarios que no son el host, pero que tienen autoridad, deben enviar un comando al host que cambiará la variable.</span><span class="sxs-lookup"><span data-stu-id="deb4c-428">Users who are not the host, but have authority, need to send a 'command' to the host which will change the variable.</span></span> <span data-ttu-id="deb4c-429">De forma predeterminada, el host tiene autoridad sobre todos los objetos, salvo el objeto generado para representar al usuario.</span><span class="sxs-lookup"><span data-stu-id="deb4c-429">By default the host has authority over all objects, except for the object spawned to represent the user.</span></span> <span data-ttu-id="deb4c-430">En nuestro caso, este objeto tiene el script playercontroller.</span><span class="sxs-lookup"><span data-stu-id="deb4c-430">In our case this object has the playercontroller script.</span></span> <span data-ttu-id="deb4c-431">Hay una manera de solicitar la autoridad para un objeto y, a continuación, realizar cambios, pero optamos por aprovechar el hecho de que el controlador del reproductor tiene autoautoridad y enrutar los comandos a través del controlador del reproductor.</span><span class="sxs-lookup"><span data-stu-id="deb4c-431">There is a way to request authority for an object and then make changes, but we choose to leverage the fact that the player controller has self authority and route commands through the player controller.</span></span>

<span data-ttu-id="deb4c-432">Dicho de otro modo, cuando nos encontramos en nuestro objetivo, el jugador debe indicar al host y el host indicará a todos los demás usuarios.</span><span class="sxs-lookup"><span data-stu-id="deb4c-432">Said another way, when we've found ourselves at our goal, the player needs to tell the host, and the host will tell everyone else.</span></span>

<span data-ttu-id="deb4c-433">De nuevo en LevelControl.cs, consulte SetGoalIndex.</span><span class="sxs-lookup"><span data-stu-id="deb4c-433">Back in LevelControl.cs look at SetGoalIndex.</span></span> <span data-ttu-id="deb4c-434">Aquí se establece el valor de un valor en synclist (AtGoal).</span><span class="sxs-lookup"><span data-stu-id="deb4c-434">Here we are setting the value of a value in a synclist (AtGoal).</span></span> <span data-ttu-id="deb4c-435">Recuerde que estamos en el contexto del host mientras hacemos esto.</span><span class="sxs-lookup"><span data-stu-id="deb4c-435">Remember that we are in the context of the host while we do this.</span></span> <span data-ttu-id="deb4c-436">De forma similar a un comando, una RPC es algo que el host puede emitir y que hará que todos los clientes ejecuten código.</span><span class="sxs-lookup"><span data-stu-id="deb4c-436">Similar to a command, an RPC is something the host can issue that will cause all clients to run some code.</span></span> <span data-ttu-id="deb4c-437">Aquí llamamos a ' RpcCheckAllGoals '.</span><span class="sxs-lookup"><span data-stu-id="deb4c-437">Here we call 'RpcCheckAllGoals'.</span></span> <span data-ttu-id="deb4c-438">Cada cliente comprobará individualmente si se han establecido los tres AtGoals y, si es así, iniciará el Rocket.</span><span class="sxs-lookup"><span data-stu-id="deb4c-438">Each client will individually check to see if all three AtGoals are set, and if so, launch the rocket.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="deb4c-439">Disfrute de su progreso</span><span class="sxs-lookup"><span data-stu-id="deb4c-439">Enjoy your progress</span></span>

<span data-ttu-id="deb4c-440">En el capítulo anterior, se iniciará la sesión como antes.</span><span class="sxs-lookup"><span data-stu-id="deb4c-440">Building on the previous chapter, we will start the session as before.</span></span> <span data-ttu-id="deb4c-441">Esta vez, a medida que los usuarios del casco envolvente lleguen a la "puerta" en su ruta de acceso, aparecerá una información sobre herramientas que solo pueden ver los usuarios de HoloLens.</span><span class="sxs-lookup"><span data-stu-id="deb4c-441">This time as the users in the immersive headset get to the "door" on their path, a tooltip will appear that only the HoloLens users can see.</span></span> <span data-ttu-id="deb4c-442">Los usuarios de HoloLens son responsables de comunicar esta pista a los usuarios en el casco envolvente.</span><span class="sxs-lookup"><span data-stu-id="deb4c-442">The HoloLens users are responsible for communicating this clue to the users in the immersive headset.</span></span> <span data-ttu-id="deb4c-443">El cohete se iniciará en el espacio una vez que cada Avatar esté escalonado en su correspondiente controlador marrón dentro de la Volcano.</span><span class="sxs-lookup"><span data-stu-id="deb4c-443">The rocket will launch to space once each avatar has stepped on its corresponding brown pad inside the volcano.</span></span> <span data-ttu-id="deb4c-444">La escena se restablecerá después de 60 segundos para que pueda volver a hacerlo.</span><span class="sxs-lookup"><span data-stu-id="deb4c-444">The scene will reset after 60 seconds so you can do it again.</span></span>

## <a name="see-also"></a><span data-ttu-id="deb4c-445">Vea también</span><span class="sxs-lookup"><span data-stu-id="deb4c-445">See also</span></span>
* [<span data-ttu-id="deb4c-446">MR Input 213: controladores de movimiento</span><span class="sxs-lookup"><span data-stu-id="deb4c-446">MR Input 213: Motion controllers</span></span>](mixed-reality-213.md)
